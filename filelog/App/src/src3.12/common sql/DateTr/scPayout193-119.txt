
delete from scPayout-- WHERE PayoutID LIKE('%201411%')
delete from scPayoutSum --where PayoutID LIKE('%201411%')
delete from scPayoutDetail -- where PayoutID LIKE('%201411%')
delete from scPayoutAdj-- where PayoutID LIKE('%201411%')

DELETE FROM scPayoutRoadShowDetail-- where  PayoutID LIKE('%201411%')



insert into  scPayout select * from openrowset('sqloledb','10.54.14.193';'scoredb';'scDB@sn05',Score.dbo.scPayout) --where PayoutID LIKE('%201411%')

--insert into  scPayoutSum select * from  openrowset('sqloledb','10.54.14.193';'scoredb';'scDB@sn05',Score.dbo.scPayoutSum)  SUBSTRING(PayoutID,1,6)='201501' --cast
--insert into  scPayoutDetail  select * from  openrowset('sqloledb','10.54.14.193'';'scoredb';'scDB@sn05',Score.dbo.scPayoutDetail) SUBSTRING(PayoutID,1,6)='201501' --cast
  insert into  scPayoutAdj  select * from openrowset('sqloledb','10.54.14.193';'scoredb';'scDB@sn05',Score.dbo.scPayoutAdj)--WHERE PayoutID LIKE('%201411%')
--insert into  scPayoutRoadShowDetail select * from openrowset('sqloledb','10.54.14.193';'scoredb';'scDB@sn05',Score.dbo.scPayoutRoadShowDetail) SUBSTRING(PayoutID,1,6)='201501'  --cast
------------------------------

 insert into scPayoutSum(
 PayoutID,
RefPayoutID,
RatioIndv,
RatioTeam,
TotalTargetConn,
ProratedTotalTargetConn,
TotalTargetPoint,
TotalActualConn,
TotalCustActualConn,
TotalActualPoint,
TotalCustActualPoint,
TotalConnAchievement,
TotalPointAchievement,
CreatedDt,
CreatedBy,
UpdatedDt,
UpdatedBy,
PreparedBy,
PreparedDt
 
 )
 select 
 
 PayoutID,
RefPayoutID,
RatioIndv,
RatioTeam,
TotalTargetConn,
ProratedTotalTargetConn,
TotalTargetPoint,
TotalActualConn,
TotalCustActualConn,
TotalActualPoint,
TotalCustActualPoint,
TotalConnAchievement,
TotalPointAchievement,
CAST(CreatedDt as datetime),
CreatedBy,
CAST(UpdatedDt as datetime),
UpdatedBy,
PreparedBy,
 CAST(PreparedDt as datetime) 
 from   openrowset('sqloledb','10.54.14.193';'scoredb';'scDB@sn05',Score.dbo.scPayoutSum) 


----------------

insert into scPayoutDetail(
 PayoutID,
SchemeDetID,
ProductCode,
ProductDesc,
ProductCat,
ProductCatDesc,
ProductSeq,
ProdLineType,
ProdCommRule,
ProductType,
ProductTierCode,
ProductListCode,
ProductValue,
ProductWT,
ProductLineCount,
SchemeWTID,
WeightageType,
WeightageBy,
WeightageValue,
TargetConn,
TargetPoint,
ActualConn,
ActualPoint,
AchievementConn,
AchievementPoint,
CreatedDt,
CreatedBy,
UpdatedDt,
UpdatedBy,
--ID,
CustActualConn,
CustActualPoint
 )
 select 
 
PayoutID,
SchemeDetID,
ProductCode,
ProductDesc,
ProductCat,
ProductCatDesc,
ProductSeq,
ProdLineType,
ProdCommRule,
ProductType,
ProductTierCode,
ProductListCode,
ProductValue,
ProductWT,
ProductLineCount,
SchemeWTID,
WeightageType,
WeightageBy,
WeightageValue,
TargetConn,
TargetPoint,
ActualConn,
ActualPoint,
AchievementConn,
AchievementPoint,
cast(CreatedDt as datetime),
CreatedBy,
cast(UpdatedDt as datetime),
UpdatedBy,
--ID,
CustActualConn,
CustActualPoint
 from openrowset('sqloledb','10.54.14.193';'scoredb';'scDB@sn05',Score.dbo.scPayoutDetail) 
-----------------------------------------
insert into scPayoutRoadShowDetail(
 PayoutID,
SchemeDetID,
ProductCode,
ProductDesc,
ProductCat,
ProductCatDesc,
ProductSeq,
ProdLineType,
ProdCommRule,
ProductType,
ProductTierCode,
ProductListCode,
ProductValue,
ProductWT,
ProductLineCount,
SchemeWTID,
WeightageType,
WeightageBy,
WeightageValue,
ActualConn,
CustActualConn,
ActualPoint,
CustActualPoint,
CreatedDt,
CreatedBy,
UpdatedDt,
UpdatedBy
--ID
 )
 select 
 
PayoutID,
SchemeDetID,
ProductCode,
ProductDesc,
ProductCat,
ProductCatDesc,
ProductSeq,
ProdLineType,
ProdCommRule,
ProductType,
ProductTierCode,
ProductListCode,
ProductValue,
ProductWT,
ProductLineCount,
SchemeWTID,
WeightageType,
WeightageBy,
WeightageValue,
ActualConn,
CustActualConn,
ActualPoint,
CustActualPoint,
cast(CreatedDt as datetime),
CreatedBy,
cast(UpdatedDt as datetime),
UpdatedBy
--ID,
 from openrowset('sqloledb','10.54.14.193';'scoredb';'scDB@sn05',Score.dbo.scPayoutRoadShowDetail ) 